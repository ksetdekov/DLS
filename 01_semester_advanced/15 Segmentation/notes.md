# Segmentation

1. Детекция - обвести людей прямоугольниками
2. Семантическая сегментация - покрасить всех людей в цвет
3. Инстанс сегменатция - покрасить каждого человека в свой цвет

## постановка задачи

1. на выход - выдать картику размера как входная, где для каждого пикселя - указан класс, что есть

## варианты

### архитектуры

* SegNet
* DeepLab
* PSPNet
* UNet
* Mask R-CNN - сложнее, это сетки для детекции + что-то еще

### sliding window

нарезать окном, что центр окна - пиксель. Пройдем по всему изображению и классифицируем - долго и не берем информацию о соседей

### FCN

конволюции так чтобы карты активации были размером как и входное (паддинг)
CNN

последний слой - $H\cdot W \cdot C$ - где C - число классов на что делим и берем аргмакс по C

Лучше, но очень большие конволюционные слои $\rightarrow$ много параметров

### CNN

Возьмем сетку, как обычно (Inception, VGG, whatever)

1. выкинуть FC слои в конце
2. Сделать upsampling до размера исходной картинки в конце

Можно не выкидывать FC, а только последний слой - из вектора делать upsampling в картинку

Минусы - сегментация не очень точная
Мы теряем пространственную информацию изза upsampling, downsampling + stride - теряют пространственную информацию

Можно делать построцессинг после upsampling (CRF postprocessing)

## Трюки

transposed convolution (deconvolution)
upsampling (stride, add zeros between) + kernel

## Unet

Тут примерно CNN с deconvolution + skip-connection

Похожа на букву U

### еще трюки unet

* overlap-tile - делаем паддинг, отзеркалив края
* Loss - pixel-wise Softmax loss with weight (большой вес для границ между классами)
